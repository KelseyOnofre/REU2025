<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Wrangling</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Visualization in R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li>
  <a href="pre_work.html">Pre-Work</a>
</li>
<li>
  <a href="IntrotoR.html">Intro to R</a>
</li>
<li>
  <a href="Graphing.html">Graphing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Data Wrangling</h1>

</div>


<div id="read-in-data" class="section level2">
<h2>Read in Data</h2>
<p>There are many ways to bring data into R. One of the simplist is
using read.csv() to read in a csv file from your working directory.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>FHB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;DataSetFHB.csv&quot;</span>) <span class="do">## read.csv() will allow you to read in .csv files.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">head</span>(FHB) <span class="co"># head() lets examine the first few rows of data</span></span></code></pre></div>
<pre><code>##   YEAR        LOC    ENV REP     VAR TRT    TW    YLD INC SEV   IND FDK  DON
## 1 2019 Belleville BEL_19   1  WB4458   1 50.20  68.47  48  75 36.00  20 2.50
## 2 2019 Belleville BEL_19   1  WB4458   2 50.61  64.56  30  50 15.00  30 3.90
## 3 2019 Belleville BEL_19   1  WB4458   3 53.63  66.71  30  65 19.50  30 3.00
## 4 2019 Belleville BEL_19   1  WB4458   4 54.03  81.26  36  60 21.60   8 1.80
## 5 2019 Belleville BEL_19   1 BobDole   1 55.57  96.57  12  25  3.00   5 0.80
## 6 2019 Belleville BEL_19   1 BobDole   2 58.41 116.72   5   5  0.25   5 0.82</code></pre>
<p><br><br />
<br></p>
</div>
<div id="data-wrangling" class="section level2">
<h2>Data Wrangling</h2>
<p>In this short workshop we will focus on Tidyverse. Tidyverse is a
“package of packages” that includes many tools for data organization and
visualization. All of the packages are easy to use together, because
they use the same code grammer. Today we will focus mostly on the
packages “ggplot2” and “dplyr” which are useful for graphing and data
manipulation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>FHB <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(FHB) <span class="co">#a tibble is a data frames that works well with the tidyverse</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>FHB</span></code></pre></div>
<pre><code>## # A tibble: 192 × 13
##     YEAR LOC   ENV     REP VAR     TRT    TW   YLD   INC   SEV   IND   FDK   DON
##    &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2019 Bell… BEL_…     1 WB44…     1  50.2  68.5    48    75 36       20  2.5 
##  2  2019 Bell… BEL_…     1 WB44…     2  50.6  64.6    30    50 15       30  3.9 
##  3  2019 Bell… BEL_…     1 WB44…     3  53.6  66.7    30    65 19.5     30  3   
##  4  2019 Bell… BEL_…     1 WB44…     4  54.0  81.3    36    60 21.6      8  1.8 
##  5  2019 Bell… BEL_…     1 BobD…     1  55.6  96.6    12    25  3        5  0.8 
##  6  2019 Bell… BEL_…     1 BobD…     2  58.4 117.      5     5  0.25     5  0.82
##  7  2019 Bell… BEL_…     1 BobD…     3  59.4 111.      5     5  0.25     1  0.56
##  8  2019 Bell… BEL_…     1 BobD…     4  60.4 113.      7    40  2.8      3  0.55
##  9  2019 Bell… BEL_…     1 Zenda     1  54.4  79.3     5    50  2.5      4  1.4 
## 10  2019 Bell… BEL_…     1 Zenda     2  61.4  94.8     1     5  0.05     3  0.45
## # ℹ 182 more rows</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">glimpse</span>(FHB) <span class="do">## check </span></span></code></pre></div>
<pre><code>## Rows: 192
## Columns: 13
## $ YEAR &lt;int&gt; 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019,…
## $ LOC  &lt;chr&gt; &quot;Belleville&quot;, &quot;Belleville&quot;, &quot;Belleville&quot;, &quot;Belleville&quot;, &quot;Bellevil…
## $ ENV  &lt;chr&gt; &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_…
## $ REP  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
## $ VAR  &lt;chr&gt; &quot;WB4458&quot;, &quot;WB4458&quot;, &quot;WB4458&quot;, &quot;WB4458&quot;, &quot;BobDole&quot;, &quot;BobDole&quot;, &quot;Bo…
## $ TRT  &lt;int&gt; 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2,…
## $ TW   &lt;dbl&gt; 50.20, 50.61, 53.63, 54.03, 55.57, 58.41, 59.38, 60.40, 54.37, 61…
## $ YLD  &lt;dbl&gt; 68.47, 64.56, 66.71, 81.26, 96.57, 116.72, 110.53, 112.91, 79.30,…
## $ INC  &lt;dbl&gt; 48, 30, 30, 36, 12, 5, 5, 7, 5, 1, 2, 3, 35, 15, 19, 27, 9, 7, 3,…
## $ SEV  &lt;dbl&gt; 75, 50, 65, 60, 25, 5, 5, 40, 50, 5, 5, 40, 70, 50, 75, 75, 50, 5…
## $ IND  &lt;dbl&gt; 36.00, 15.00, 19.50, 21.60, 3.00, 0.25, 0.25, 2.80, 2.50, 0.05, 0…
## $ FDK  &lt;dbl&gt; 20, 30, 30, 8, 5, 5, 1, 3, 4, 3, 3, 4, 23, 12, 10, 7, 8, 3, 3, 1,…
## $ DON  &lt;dbl&gt; 2.50, 3.90, 3.00, 1.80, 0.80, 0.82, 0.56, 0.55, 1.40, 0.45, 0.59,…</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>FHB <span class="ot">&lt;-</span> FHB <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">TRT =</span> <span class="fu">as.factor</span>(TRT))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">glimpse</span>(FHB) </span></code></pre></div>
<pre><code>## Rows: 192
## Columns: 13
## $ YEAR &lt;int&gt; 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019,…
## $ LOC  &lt;chr&gt; &quot;Belleville&quot;, &quot;Belleville&quot;, &quot;Belleville&quot;, &quot;Belleville&quot;, &quot;Bellevil…
## $ ENV  &lt;chr&gt; &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_19&quot;, &quot;BEL_…
## $ REP  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
## $ VAR  &lt;chr&gt; &quot;WB4458&quot;, &quot;WB4458&quot;, &quot;WB4458&quot;, &quot;WB4458&quot;, &quot;BobDole&quot;, &quot;BobDole&quot;, &quot;Bo…
## $ TRT  &lt;fct&gt; 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2,…
## $ TW   &lt;dbl&gt; 50.20, 50.61, 53.63, 54.03, 55.57, 58.41, 59.38, 60.40, 54.37, 61…
## $ YLD  &lt;dbl&gt; 68.47, 64.56, 66.71, 81.26, 96.57, 116.72, 110.53, 112.91, 79.30,…
## $ INC  &lt;dbl&gt; 48, 30, 30, 36, 12, 5, 5, 7, 5, 1, 2, 3, 35, 15, 19, 27, 9, 7, 3,…
## $ SEV  &lt;dbl&gt; 75, 50, 65, 60, 25, 5, 5, 40, 50, 5, 5, 40, 70, 50, 75, 75, 50, 5…
## $ IND  &lt;dbl&gt; 36.00, 15.00, 19.50, 21.60, 3.00, 0.25, 0.25, 2.80, 2.50, 0.05, 0…
## $ FDK  &lt;dbl&gt; 20, 30, 30, 8, 5, 5, 1, 3, 4, 3, 3, 4, 23, 12, 10, 7, 8, 3, 3, 1,…
## $ DON  &lt;dbl&gt; 2.50, 3.90, 3.00, 1.80, 0.80, 0.82, 0.56, 0.55, 1.40, 0.45, 0.59,…</code></pre>
</div>
<div id="filtering" class="section level2">
<h2>Filtering</h2>
<p>It is often important to filter out parts of a data set. For example,
you may want to look at a single time point within a data set. For that,
filter() is useful. This is also a good time to introduce the concept of
the “pipe” which is either “|&gt;” or “%&gt;%”. Note: “|&gt;” was
introduced as the new pipe in R in 2021. Let’s look at an example where
we are filtering out one environment of our field data:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>FHB <span class="sc">|&gt;</span> <span class="fu">filter</span>(ENV <span class="sc">==</span> <span class="st">&quot;BEL_19&quot;</span>) <span class="do">## this new data frame won&#39;t save unless we assign it to a new object</span></span></code></pre></div>
<pre><code>## # A tibble: 48 × 13
##     YEAR LOC   ENV     REP VAR   TRT      TW   YLD   INC   SEV   IND   FDK   DON
##    &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2019 Bell… BEL_…     1 WB44… 1      50.2  68.5    48    75 36       20  2.5 
##  2  2019 Bell… BEL_…     1 WB44… 2      50.6  64.6    30    50 15       30  3.9 
##  3  2019 Bell… BEL_…     1 WB44… 3      53.6  66.7    30    65 19.5     30  3   
##  4  2019 Bell… BEL_…     1 WB44… 4      54.0  81.3    36    60 21.6      8  1.8 
##  5  2019 Bell… BEL_…     1 BobD… 1      55.6  96.6    12    25  3        5  0.8 
##  6  2019 Bell… BEL_…     1 BobD… 2      58.4 117.      5     5  0.25     5  0.82
##  7  2019 Bell… BEL_…     1 BobD… 3      59.4 111.      5     5  0.25     1  0.56
##  8  2019 Bell… BEL_…     1 BobD… 4      60.4 113.      7    40  2.8      3  0.55
##  9  2019 Bell… BEL_…     1 Zenda 1      54.4  79.3     5    50  2.5      4  1.4 
## 10  2019 Bell… BEL_…     1 Zenda 2      61.4  94.8     1     5  0.05     3  0.45
## # ℹ 38 more rows</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>FHB2 <span class="ot">&lt;-</span> FHB <span class="sc">|&gt;</span> <span class="fu">filter</span>(ENV <span class="sc">==</span> <span class="st">&quot;BEL_19&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>FHB2 <span class="do">## new data frame filters to just a single environment</span></span></code></pre></div>
<pre><code>## # A tibble: 48 × 13
##     YEAR LOC   ENV     REP VAR   TRT      TW   YLD   INC   SEV   IND   FDK   DON
##    &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2019 Bell… BEL_…     1 WB44… 1      50.2  68.5    48    75 36       20  2.5 
##  2  2019 Bell… BEL_…     1 WB44… 2      50.6  64.6    30    50 15       30  3.9 
##  3  2019 Bell… BEL_…     1 WB44… 3      53.6  66.7    30    65 19.5     30  3   
##  4  2019 Bell… BEL_…     1 WB44… 4      54.0  81.3    36    60 21.6      8  1.8 
##  5  2019 Bell… BEL_…     1 BobD… 1      55.6  96.6    12    25  3        5  0.8 
##  6  2019 Bell… BEL_…     1 BobD… 2      58.4 117.      5     5  0.25     5  0.82
##  7  2019 Bell… BEL_…     1 BobD… 3      59.4 111.      5     5  0.25     1  0.56
##  8  2019 Bell… BEL_…     1 BobD… 4      60.4 113.      7    40  2.8      3  0.55
##  9  2019 Bell… BEL_…     1 Zenda 1      54.4  79.3     5    50  2.5      4  1.4 
## 10  2019 Bell… BEL_…     1 Zenda 2      61.4  94.8     1     5  0.05     3  0.45
## # ℹ 38 more rows</code></pre>
</div>
<div id="summarise" class="section level2">
<h2>Summarise</h2>
<p>You can also summarize data using dplyr summarise().</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>avgIND <span class="ot">&lt;-</span> FHB <span class="sc">|&gt;</span> <span class="do">## data set to take an action on</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">group_by</span>(VAR, TRT) <span class="sc">|&gt;</span> <span class="do">## how I want my data grouped. Here I will summarize for each treatment, by variety</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanIND =</span> <span class="fu">mean</span>(IND)) <span class="do">## meanIND is the name for my new, summarize column in my data set. I will use mean() to summarize disease  INDEX. </span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;VAR&#39;. You can override using the `.groups`
## argument.</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>avgIND</span></code></pre></div>
<pre><code>## # A tibble: 12 × 3
## # Groups:   VAR [3]
##    VAR     TRT   meanIND
##    &lt;chr&gt;   &lt;fct&gt;   &lt;dbl&gt;
##  1 BobDole 1       8.29 
##  2 BobDole 2       6.65 
##  3 BobDole 3       2.67 
##  4 BobDole 4       4.09 
##  5 WB4458  1      26.4  
##  6 WB4458  2      16.8  
##  7 WB4458  3       8.82 
##  8 WB4458  4      12.9  
##  9 Zenda   1       3.20 
## 10 Zenda   2       1.49 
## 11 Zenda   3       0.685
## 12 Zenda   4       2.02</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>avgIND <span class="ot">&lt;-</span> FHB <span class="sc">|&gt;</span> <span class="do">## data set to take an action on</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">group_by</span>(VAR) <span class="sc">|&gt;</span> <span class="do">## how I want my data grouped. Here I will summarize across variety</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanIND =</span> <span class="fu">mean</span>(IND, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="do">## meanIND is the name for my new, summarize column in my data set. I will use mean() to summarize disease  INDEX. Remove nas. </span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>avgIND</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   VAR     meanIND
##   &lt;chr&gt;     &lt;dbl&gt;
## 1 BobDole    5.43
## 2 WB4458    16.2 
## 3 Zenda      1.85</code></pre>
</div>
<div id="re-arrange-data" class="section level2">
<h2>Re-arrange data</h2>
<ul>
<li>mutate()<br />
</li>
<li>select()<br />
</li>
<li>rename()<br />
</li>
<li>relocate()</li>
</ul>
<div id="mutate" class="section level3">
<h3>Mutate</h3>
<p>You can use mutate() to calculate a new column in your dataframe
based on values in the existing data</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>FHB <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>    <span class="at">INDEX =</span> (INC<span class="sc">*</span>SEV)<span class="sc">/</span><span class="dv">100</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    <span class="at">.after =</span> <span class="dv">2</span> <span class="do">## put the new column after the second column so we can see it more easily. </span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 192 × 14
##     YEAR LOC   INDEX ENV     REP VAR   TRT      TW   YLD   INC   SEV   IND   FDK
##    &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2019 Bell… 36    BEL_…     1 WB44… 1      50.2  68.5    48    75 36       20
##  2  2019 Bell… 15    BEL_…     1 WB44… 2      50.6  64.6    30    50 15       30
##  3  2019 Bell… 19.5  BEL_…     1 WB44… 3      53.6  66.7    30    65 19.5     30
##  4  2019 Bell… 21.6  BEL_…     1 WB44… 4      54.0  81.3    36    60 21.6      8
##  5  2019 Bell…  3    BEL_…     1 BobD… 1      55.6  96.6    12    25  3        5
##  6  2019 Bell…  0.25 BEL_…     1 BobD… 2      58.4 117.      5     5  0.25     5
##  7  2019 Bell…  0.25 BEL_…     1 BobD… 3      59.4 111.      5     5  0.25     1
##  8  2019 Bell…  2.8  BEL_…     1 BobD… 4      60.4 113.      7    40  2.8      3
##  9  2019 Bell…  2.5  BEL_…     1 Zenda 1      54.4  79.3     5    50  2.5      4
## 10  2019 Bell…  0.05 BEL_…     1 Zenda 2      61.4  94.8     1     5  0.05     3
## # ℹ 182 more rows
## # ℹ 1 more variable: DON &lt;dbl&gt;</code></pre>
</div>
<div id="select" class="section level3">
<h3>Select</h3>
<p>This is another option for subsetting out our data.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>FHB <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">select</span>(VAR, TRT, YLD)</span></code></pre></div>
<pre><code>## # A tibble: 192 × 3
##    VAR     TRT     YLD
##    &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt;
##  1 WB4458  1      68.5
##  2 WB4458  2      64.6
##  3 WB4458  3      66.7
##  4 WB4458  4      81.3
##  5 BobDole 1      96.6
##  6 BobDole 2     117. 
##  7 BobDole 3     111. 
##  8 BobDole 4     113. 
##  9 Zenda   1      79.3
## 10 Zenda   2      94.8
## # ℹ 182 more rows</code></pre>
</div>
<div id="rename" class="section level3">
<h3>Rename</h3>
<p>Sometimes it can be useful to rename our columns without going back
to the origional file.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>FHB <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Variety =</span> VAR)</span></code></pre></div>
<pre><code>## # A tibble: 192 × 13
##     YEAR LOC       ENV     REP Variety TRT      TW   YLD   INC   SEV   IND   FDK
##    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2019 Bellevil… BEL_…     1 WB4458  1      50.2  68.5    48    75 36       20
##  2  2019 Bellevil… BEL_…     1 WB4458  2      50.6  64.6    30    50 15       30
##  3  2019 Bellevil… BEL_…     1 WB4458  3      53.6  66.7    30    65 19.5     30
##  4  2019 Bellevil… BEL_…     1 WB4458  4      54.0  81.3    36    60 21.6      8
##  5  2019 Bellevil… BEL_…     1 BobDole 1      55.6  96.6    12    25  3        5
##  6  2019 Bellevil… BEL_…     1 BobDole 2      58.4 117.      5     5  0.25     5
##  7  2019 Bellevil… BEL_…     1 BobDole 3      59.4 111.      5     5  0.25     1
##  8  2019 Bellevil… BEL_…     1 BobDole 4      60.4 113.      7    40  2.8      3
##  9  2019 Bellevil… BEL_…     1 Zenda   1      54.4  79.3     5    50  2.5      4
## 10  2019 Bellevil… BEL_…     1 Zenda   2      61.4  94.8     1     5  0.05     3
## # ℹ 182 more rows
## # ℹ 1 more variable: DON &lt;dbl&gt;</code></pre>
</div>
<div id="relocate" class="section level3">
<h3>Relocate</h3>
<p>It can be useful to move columns around in our data frame.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>FHB <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">relocate</span>(YEAR<span class="sc">:</span>REP, <span class="at">.after =</span> TRT) <span class="do">## here we move the columns from year to rep to after the TRT column </span></span></code></pre></div>
<pre><code>## # A tibble: 192 × 13
##    VAR   TRT    YEAR LOC   ENV     REP    TW   YLD   INC   SEV   IND   FDK   DON
##    &lt;chr&gt; &lt;fct&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 WB44… 1      2019 Bell… BEL_…     1  50.2  68.5    48    75 36       20  2.5 
##  2 WB44… 2      2019 Bell… BEL_…     1  50.6  64.6    30    50 15       30  3.9 
##  3 WB44… 3      2019 Bell… BEL_…     1  53.6  66.7    30    65 19.5     30  3   
##  4 WB44… 4      2019 Bell… BEL_…     1  54.0  81.3    36    60 21.6      8  1.8 
##  5 BobD… 1      2019 Bell… BEL_…     1  55.6  96.6    12    25  3        5  0.8 
##  6 BobD… 2      2019 Bell… BEL_…     1  58.4 117.      5     5  0.25     5  0.82
##  7 BobD… 3      2019 Bell… BEL_…     1  59.4 111.      5     5  0.25     1  0.56
##  8 BobD… 4      2019 Bell… BEL_…     1  60.4 113.      7    40  2.8      3  0.55
##  9 Zenda 1      2019 Bell… BEL_…     1  54.4  79.3     5    50  2.5      4  1.4 
## 10 Zenda 2      2019 Bell… BEL_…     1  61.4  94.8     1     5  0.05     3  0.45
## # ℹ 182 more rows</code></pre>
<p><br></p>
</div>
</div>
<div id="graphing" class="section level2">
<h2>Graphing</h2>
<p>Here we will walk through the basics of creating graphs with ggplot2.
There are extensive options available within the ggplot2 framework.
Would encourage you to explore the vast online documentation on the
subject. Here we will aim to become familiar with the logic behind
ggplot2 graphs.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  <span class="fu">scale_color_bmj</span>() <span class="sc">+</span> </span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;FHB Index in response to variety and fungicide&quot;</span>, </span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">&quot;FHB Index (%)&quot;</span>,</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>() ,</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>    <span class="at">panel.border     =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>) ,</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>    </span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>    <span class="at">axis.text.y  =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>    <span class="at">axis.text.x  =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>    </span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>    </span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>    <span class="at">strip.text.x =</span>  <span class="fu">element_text</span>(<span class="at">hjust =</span><span class="fl">0.01</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>    <span class="at">strip.background =</span>  <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>the ggplot fungicide is “buildable”</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="do">### simply initiates a blank graph</span></span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="do">## specify data source and x and y axis</span></span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-10-2.png" width="672" />
Now we can tell ggplot what type of graph we want. Let’s start with a
boxplot.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Violin plots are similar. We can layer elements. We can also adjust
the width of the elements.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND))  <span class="sc">+</span> <span class="fu">geom_violin</span>() <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Here we can make a more simple bar chart and let ggplot know that we
want to summarize the data (will default to the mean).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND))  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>)</span></code></pre></div>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="Graphing_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Here we can layer points on our boxplot.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>It is often useful to “jitter” the points for easier
visualization.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="co"># layer jittered points on  top of our box plot</span></span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>We can start to adjust the look. Notice that size affects the size of
the points, width tells us how wide our points go. The alpha allows us
to make the points transparent. Try playing around with those
numbers.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="do">## adjust the look of the points. </span></span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Facet can be useful when we have logical groups to our data like
timepoints or treatments. Here we can group our fungicide treatments by
variety.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="co">#facet</span></span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>There are many ways to adjust colors of a graph. Here, let’s change
the color of the points. Here I chose random colors. R knows certain
colors and there are good lists online. R can also read hex codes.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> <span class="co"># color specified here</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;pink&quot;</span>, <span class="st">&quot;orange&quot;</span>)) <span class="co">#set color of points </span></span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Packages exist that have pre-determined color palettes. Here we use
the library ggsci and a palette that matches the journal bmj. There are
many options available. Would you like to test a few?</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  <span class="fu">scale_color_bmj</span>()</span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>ggplot has a few set themes that change the overall look of our plot.
Here we use “theme_bw”.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  <span class="fu">scale_color_bmj</span>() <span class="sc">+</span> </span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>We often want to customize our plot labels.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>  <span class="fu">scale_color_bmj</span>() <span class="sc">+</span> </span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="co"># set text size</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;FHB Index in response to variety and fungicide&quot;</span>, </span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">&quot;FHB Index (%)&quot;</span>,</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span>) </span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>We can use theme() to change many aspects of the graph instead of (or
in addtion to) using the preset themes like theme_bw().</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FHB, <span class="fu">aes</span>(<span class="at">x =</span> TRT, <span class="at">y =</span> IND)) <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> TRT), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VAR, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  <span class="fu">scale_color_bmj</span>() <span class="sc">+</span> </span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;FHB Index in response to variety and fungicide&quot;</span>, </span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">&quot;FHB Index (%)&quot;</span>,</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="sc">+</span> </span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>() ,</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>    <span class="at">panel.border     =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>) ,</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>    </span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>    <span class="at">axis.text.y  =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>    <span class="at">axis.text.x  =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a>    </span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb42-20"><a href="#cb42-20" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb42-21"><a href="#cb42-21" tabindex="-1"></a>    </span>
<span id="cb42-22"><a href="#cb42-22" tabindex="-1"></a>    <span class="at">strip.text.x =</span>  <span class="fu">element_text</span>(<span class="at">hjust =</span><span class="fl">0.01</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb42-23"><a href="#cb42-23" tabindex="-1"></a>    <span class="at">strip.background =</span>  <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Graphing_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Final note: sometimes it is necessary to bring together two graphs
and to add letter annotation (A, B, etc.). The package ‘ggpubr’ is great
for that application.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
